import{a1 as L,S as z,i as C,s as J,e as b,c as v,a as k,d as f,b as m,f as y,k as w,t as M,n as D,g as G,H as g,N as Q,V,l as x,ab as B,ac as H,I as N,A as R}from"../chunks/vendor-10aa861a.js";import{u as U,z as W,s as q}from"../chunks/constants-d7e005c3.js";import{b as A}from"../chunks/paths-28a87002.js";function S(r,t,e){const s=r.slice();return s[10]=t[e],s}function O(r){let t,e=r[2],s=[];for(let a=0;a<e.length;a+=1)s[a]=P(S(r,e,a));return{c(){t=b("div");for(let a=0;a<s.length;a+=1)s[a].c();this.h()},l(a){t=v(a,"DIV",{class:!0});var l=k(t);for(let o=0;o<s.length;o+=1)s[o].l(l);l.forEach(f),this.h()},h(){m(t,"class","controls svelte-1ve7sum")},m(a,l){y(a,t,l);for(let o=0;o<s.length;o+=1)s[o].m(t,null)},p(a,l){if(l&6){e=a[2];let o;for(o=0;o<e.length;o+=1){const u=S(a,e,o);s[o]?s[o].p(u,l):(s[o]=P(u),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=e.length}},d(a){a&&f(t),V(s,a)}}}function P(r){let t,e,s,a=W(r[10])+"",l,o,u,i;return{c(){t=b("label"),e=b("input"),s=w(),l=M(a),o=w(),this.h()},l(n){t=v(n,"LABEL",{class:!0});var c=k(t);e=v(c,"INPUT",{type:!0,name:!0}),s=D(c),l=G(c,a),o=D(c),c.forEach(f),this.h()},h(){m(e,"type","radio"),m(e,"name","plans"),e.__value=r[10],e.value=e.__value,r[7][0].push(e),m(t,"class","svelte-1ve7sum")},m(n,c){y(n,t,c),g(t,e),e.checked=e.__value===r[1],g(t,s),g(t,l),g(t,o),u||(i=Q(e,"change",r[6]),u=!0)},p(n,c){c&2&&(e.checked=e.__value===n[1])},d(n){n&&f(t),r[7][0].splice(r[7][0].indexOf(e),1),u=!1,i()}}}function X(r){let t,e,s,a,l,o,u,i=r[0]&&O(r);return{c(){t=b("link"),e=b("script"),a=w(),l=b("div"),o=w(),i&&i.c(),u=x(),this.h()},l(n){const c=B('[data-svelte="svelte-1p75gtx"]',document.head);t=v(c,"LINK",{href:!0,rel:!0}),e=v(c,"SCRIPT",{src:!0});var E=k(e);E.forEach(f),c.forEach(f),a=D(n),l=v(n,"DIV",{id:!0,class:!0}),k(l).forEach(f),o=D(n),i&&i.l(n),u=x(),this.h()},h(){m(t,"href","https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.css"),m(t,"rel","stylesheet"),H(e.src,s="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.js")||m(e,"src",s),m(l,"id","map"),m(l,"class","svelte-1ve7sum")},m(n,c){g(document.head,t),g(document.head,e),y(n,a,c),y(n,l,c),y(n,o,c),i&&i.m(n,c),y(n,u,c)},p(n,[c]){n[0]?i?i.p(n,c):(i=O(n),i.c(),i.m(u.parentNode,u)):i&&(i.d(1),i=null)},i:N,o:N,d(n){f(t),f(e),n&&f(a),n&&f(l),n&&f(o),i&&i.d(n),n&&f(u)}}}async function ee({fetch:r}){const t=await r(`${A}/plans.topojson`),s=await(await r(`${A}/output_census_wgs84.topojson`)).json(),a=U(s.objects.census),l=L(s,a);return{props:{topoData:await t.json(),census:l}}}const I="pop20",Z="pop";function K(r,t,e){let{topoData:s,census:a}=t,l,o;const u=["assembly","assembly_letters","assembly_names","senate","senate_letters","senate_names"],i={pop:[0,.1,.2,.4,.6],cvap:[0,.1,.2,.4,.6]};function n({properties:p}){if(!p.ALAND||p[`${I}_total`]<=10)return"rgba(0, 0, 0, 0)";const _=h=>p[`${I}_${h}`]/p[`${I}_total`],j=i[Z];for(let h=1;h<j.length;h++)if(_("asian")<j[h])return q[h-1];return q[j.length-1]}R(()=>{mapboxgl.accessToken="pk.eyJ1IjoianNvbmthbyIsImEiOiJjanNvM2U4bXQwN2I3NDRydXQ3Z2kwbWQwIn0.JWAoBlcpDJwkzG-O5_r0ZA",e(5,l=new mapboxgl.Map({container:"map",style:"mapbox://styles/jsonkao/ckvnu5tpy6coj14uizvyf1wuf/draft",center:[-73.967,40.72],zoom:12})),l.on("load",async()=>{const p=l.getStyle().layers;l.addSource("census",{type:"geojson",data:a});const d=["match",["get","GEOID"]];a.features.forEach(_=>{d.push(_.properties.GEOID,n(_))}),d.push("rgba(0, 0, 0, 0)"),l.addLayer({id:"census",type:"fill",source:"census",paint:{"fill-color":d}},"parks"),console.log(p),u.forEach(_=>{const j=L(s,s.objects[_]);l.addSource(_,{type:"geojson",data:j}),l.addLayer({id:_+"_outline",type:"line",source:_,layout:{},paint:{"line-color":"#000","line-width":1}}),l.on("click",_+"_fill",h=>{new mapboxgl.Popup().setLngLat(h.lngLat).setHTML(h.features[0].properties[_]).addTo(l)})}),e(0,o=!0)})});let c;const E=[[]];function T(){c=this.__value,e(1,c)}return r.$$set=p=>{"topoData"in p&&e(3,s=p.topoData),"census"in p&&e(4,a=p.census)},r.$$.update=()=>{r.$$.dirty&35&&o&&u.forEach(p=>{const d=p===c?"visible":"none";l.setLayoutProperty(`${p}_outline`,"visibility",d)})},[o,c,u,s,a,l,T,E]}class te extends z{constructor(t){super();C(this,t,K,X,J,{topoData:3,census:4})}}export{te as default,ee as load};
